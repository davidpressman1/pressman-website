<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>pressman.me | NY Sports & Tech</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="stylesheet" href="style.css?v=2">
</head>
<body>
  <div class="page">
    <header class="fade-in">
      <div class="brand">
        <div class="avatar">DP</div>
        <div class="titles">
          <h1>pressman.me</h1>
          <p>New York sports ¬∑ Tech ¬∑ Personal site</p>
        </div>
      </div>

      <nav>
        <a class="nav-pill" href="#scores">Scores</a>
        <a class="nav-pill" href="#about">About</a>
        <a class="nav-pill" href="#projects">Projects</a>
        <a class="nav-pill" href="mailto:info@pressman.me">Contact</a>
      </nav>
    </header>

    <!-- HERO -->
    <section class="hero">
      <div class="hero-main fade-in delay-1" id="about">
        <h2 class="hero-title">David Pressman</h2>
        <p class="hero-subtitle">
          NY sports fan, tech guy, tinkerer, and the person behind pressman.me.
        </p>

        <div class="hero-tags">
          <div class="hero-tag">‚öæ Yankees</div>
          <div class="hero-tag">üèÄ Knicks</div>
          <div class="hero-tag">üèà Giants</div>
          <div class="hero-tag">üèí Rangers</div>
          <div class="hero-tag">üíª IT and automation</div>
        </div>

        <div class="hero-note">
          Short version: I keep systems running by day and check box scores by night. This site pulls it all into one home base.
        </div>
      </div>

      <div class="mini-column">
        <div class="mini-card fade-in delay-2">
          <h3>NY scoreboard hub</h3>
          Jump into live scores for all four teams with a single click from the section below.
        </div>

        <div class="mini-card fade-in delay-3" id="projects">
          <h3>Projects</h3>
          Scripts, automations, home lab experiments, and random ideas I feel like sharing.
        </div>
      </div>
    </section>

    <!-- SCORES -->
    <section class="scores-section fade-in delay-2" id="scores">
      <div class="scores-inner">
        <h2>Live NY Sports Scores</h2>
        <p class="scores-sub">
          Tap a team to jump to live scores, schedules, and game updates.
        </p>
        <p class="scores-updated" id="scores-updated">
          Last updated from ESPN: loading‚Ä¶
        </p>

        <div class="scores-grid">
          <!-- Yankees -->
          <div class="ticket">
            <div class="ticket-top">
              <div class="ticket-team-block">
                <div class="team-badge">
                  <img src="https://upload.wikimedia.org/wikipedia/commons/7/70/NewYorkYankees_caplogo.svg"
                       alt="New York Yankees logo">
                </div>
                <div>
                  <div class="ticket-team-name">New York Yankees</div>
                  <div class="ticket-league">MLB ¬∑ Scores and schedule</div>
                </div>
              </div>

              <a class="ticket-btn"
                 href="https://www.espn.com/mlb/team/_/name/nyy/new-york-yankees"
                 target="_blank" rel="noopener noreferrer">
                View live
              </a>
            </div>
            <div class="ticket-bottom" id="score-yankees">
              Yankees last game: loading‚Ä¶
            </div>
          </div>

          <!-- Knicks -->
          <div class="ticket">
            <div class="ticket-top">
              <div class="ticket-team-block">
                <div class="team-badge">
                  <img src="https://upload.wikimedia.org/wikipedia/en/2/25/New_York_Knicks_logo.svg"
                       alt="New York Knicks logo">
                </div>
                <div>
                  <div class="ticket-team-name">New York Knicks</div>
                  <div class="ticket-league">NBA ¬∑ Scores and schedule</div>
                </div>
              </div>

              <a class="ticket-btn"
                 href="https://www.espn.com/nba/team/_/name/ny/new-york-knicks"
                 target="_blank" rel="noopener noreferrer">
                View live
              </a>
            </div>
            <div class="ticket-bottom" id="score-knicks">
              Knicks last game: loading‚Ä¶
            </div>
          </div>

          <!-- Giants -->
          <div class="ticket">
            <div class="ticket-top">
              <div class="ticket-team-block">
                <div class="team-badge">
                  <img src="https://upload.wikimedia.org/wikipedia/commons/6/60/New_York_Giants_logo.svg"
                       alt="New York Giants logo">
                </div>
                <div>
                  <div class="ticket-team-name">New York Giants</div>
                  <div class="ticket-league">NFL ¬∑ Scores and schedule</div>
                </div>
              </div>

              <a class="ticket-btn"
                 href="https://www.espn.com/nfl/team/_/name/nyg/new-york-giants"
                 target="_blank" rel="noopener noreferrer">
                View live
              </a>
            </div>
            <div class="ticket-bottom" id="score-giants">
              Giants last game: loading‚Ä¶
            </div>
          </div>

          <!-- Rangers -->
          <div class="ticket">
            <div class="ticket-top">
              <div class="ticket-team-block">
                <div class="team-badge">
                  <!-- switched to a stable ESPN logo URL -->
                  <img src="https://a.espncdn.com/i/teamlogos/nhl/500/nyr.png"
                       alt="New York Rangers logo">
                </div>
                <div>
                  <div class="ticket-team-name">New York Rangers</div>
                  <div class="ticket-league">NHL ¬∑ Scores and schedule</div>
                </div>
              </div>

              <a class="ticket-btn"
                 href="https://www.espn.com/nhl/team/_/name/nyr/new-york-rangers"
                 target="_blank" rel="noopener noreferrer">
                View live
              </a>
            </div>
            <div class="ticket-bottom" id="score-rangers">
              Rangers last game: loading‚Ä¶
            </div>
          </div>
        </div>
      </div>
    </section>

    <footer>
      ¬© <span id="year"></span> pressman.me ¬∑ Built by
      <a href="https://www.youtube.com/watch?v=dQw4w9WgXcQ" target="_blank" rel="noopener noreferrer">
        David
      </a>
    </footer>
  </div>

  <script>
    // Footer year
    document.getElementById("year").textContent = new Date().getFullYear();

    // Helper: ESPN date string YYYYMMDD
    function espnDateString(offsetDays) {
      const d = new Date();
      d.setDate(d.getDate() + offsetDays);
      const y = d.getFullYear();
      const m = String(d.getMonth() + 1).padStart(2, "0");
      const day = String(d.getDate()).padStart(2, "0");
      return `${y}${m}${day}`;
    }

    // Helper: "Oct 6"
    function niceShortDate(dateStr) {
      try {
        const d = new Date(dateStr);
        if (isNaN(d.getTime())) return "";
        return d.toLocaleDateString(undefined, { month: "short", day: "numeric" });
      } catch {
        return "";
      }
    }

    async function fetchLastGameForTeam(options) {
      const { leaguePath, abbrev, elId, label } = options;
      const el = document.getElementById(elId);
      if (!el) return;

      el.textContent = `${label}: loading‚Ä¶`;

      try {
        const maxDaysBack = 10; // search back up to 10 days
        for (let i = 0; i < maxDaysBack; i++) {
          const dates = espnDateString(-i);
          const url = `https://site.api.espn.com/apis/site/v2/sports/${leaguePath}/scoreboard?dates=${dates}`;
          const res = await fetch(url);
          if (!res.ok) continue;

          const data = await res.json();
          const events = data && data.events ? data.events : [];
          if (!events.length) continue;

          for (const ev of events) {
            const comp = ev.competitions && ev.competitions[0];
            if (!comp) continue;

            const teams = comp.competitors || [];
            if (!teams.length) continue;

            const ourTeam = teams.find(
              t =>
                t.team &&
                (t.team.abbreviation === abbrev ||
                 t.team.shortDisplayName === abbrev ||
                 t.team.name === abbrev)
            );
            if (!ourTeam) continue;

            const status = (ev.status && ev.status.type) || (comp.status && comp.status.type) || {};
            const state = (status.state || "").toLowerCase();

            const home = teams.find(t => t.homeAway === "home");
            const away = teams.find(t => t.homeAway === "away");

            const isHome =
              home && home.team && home.team.abbreviation === (ourTeam.team && ourTeam.team.abbreviation);
            const teamObj = isHome ? home : away;
            const oppObj = isHome ? away : home;

            const teamScore = teamObj && teamObj.score != null ? teamObj.score : "?";
            const oppScore = oppObj && oppObj.score != null ? oppObj.score : "?";

            let resultPrefix = "";
            const tsNum = Number(teamScore);
            const osNum = Number(oppScore);

            if (!isNaN(tsNum) && !isNaN(osNum) && state === "post") {
              if (tsNum > osNum) resultPrefix = "W ";
              else if (tsNum < osNum) resultPrefix = "L ";
              else resultPrefix = "T ";
            } else if (state.includes("in")) {
              resultPrefix = "In progress ";
            }

            const oppName =
              (oppObj &&
                oppObj.team &&
                (oppObj.team.shortDisplayName ||
                 oppObj.team.abbreviation ||
                 oppObj.team.name)) ||
              "Opponent";

            const venue = isHome ? "vs" : "@";
            const prettyDate = niceShortDate(ev.date) || dates;

            el.textContent = `${label}: ${resultPrefix}${teamScore}-${oppScore} ${venue} ${oppName} ¬∑ ${prettyDate}`;
            return;
          }
        }

        el.textContent = `${label}: no recent game found`;
      } catch (err) {
        console.error(err);
        el.textContent = `${label}: unable to load`;
      }
    }

    document.addEventListener("DOMContentLoaded", () => {
      const teams = [
        { leaguePath: "baseball/mlb",   abbrev: "NYY", elId: "score-yankees", label: "Yankees last game" },
        // Knicks back to original abbrev "NY"
        { leaguePath: "basketball/nba", abbrev: "NY",  elId: "score-knicks",  label: "Knicks last game" },
        { leaguePath: "football/nfl",   abbrev: "NYG", elId: "score-giants",  label: "Giants last game" },
        { leaguePath: "hockey/nhl",     abbrev: "NYR", elId: "score-rangers", label: "Rangers last game" }
      ];

      const updatedEl = document.getElementById("scores-updated");

      const promises = teams.map(fetchLastGameForTeam);

      Promise.all(promises).then(() => {
        if (updatedEl) {
          const now = new Date();
          const timeStr = now.toLocaleTimeString([], { hour: "numeric", minute: "2-digit" });
          updatedEl.textContent = `Last updated from ESPN: ${timeStr}`;
        }
      }).catch(() => {
        if (updatedEl) {
          updatedEl.textContent = "Last updated from ESPN: unable to confirm (API error)";
        }
      });
    });
  </script>
</body>
</html>

